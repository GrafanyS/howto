#### Сервер SSH

Следующим шагом пройдемся по параметрам сервера SSH, который отвечает за обработку нашего подключения.



Для этого откроем файл с настройками параметров. 

Это можно сделать напечатав в командной строке:

```bash
sudo nano /etc/ssh/sshd_config
```

Либо запустив midnight commander, найти, выделить файл и нажать F4. При первом запуске МС попросить выбрать предпочитаемый редактор, рекомендую выбрать **nano**

```bash
sudo mc
```



И да, большую часть команд и правок мы будем вносить используя **sudo**, (Substitute User and do, дословно «подменить пользователя и выполнить»). Это необходимо для повышения наших полномочий до уровня root



Давайте взглянем на файл конфигурации. Большинство строк с параметрами комментированы символом **#**, предполагается, что значения указанные в них - будут использованы по умолчанию. Опираясь на один из принципов программирования "явное лучше чем неявное" - пройдемся по параметрам, которые я считаю важным указать явным способом.

Пройдемся по файлу сверху вниз, и первый параметр который нам нужен выглядит так: 

```bash
#PermitRootLogin prohibit-password
```

Очевидно из названия - разрешить руту подключатся удаленно с использованием непарольных методов аутентификации. Например сканер отпечатка, смарт-карта и т.д.

Раскомментируем строку и ставим значение в **no**:

```bash
PermitRootLogin No
```

Никаких удаленных авторизаций и входов для root



Следующий параметр отвечает за возможность авторизации по SSH ключу. Мы именно таким способом и зашли на наш сервер. 

```
PubkeyAuthentication yes
```

Укажем это явно, оставляем **yes** по умолчанию, просто удалим знак комментария.



Дальше будет длинная строка с параметрами отделенными табуляцией:

```
#AuthorizedKeysFile     .ssh/authorized_keys .ssh/authorized_keys2
```

Это указание на то где искать файл с публичными частями ключей для авторизации пользователей. Оставляем как есть, просто раскомментируем.



И последний обязательный пункт:

```
#PasswordAuthentication yes
```

Удаляем символ комментария и устанавливаем параметр в **no**. Никаких парольных идентификаций, только файлы ключей.

```
PasswordAuthentication no
```



Ну а дальше, не скажу, что обязательный параметр, но просто убедитесь, что он выглядит именно так:

```
X11Forwarding yes
```

Если на сервер понадобится установить GUI, он поможет перенаправить вывод графической части запущенных приложений на вашу локальную машину.



Все. Теперь нажимаем Ctrl + X и подтверждаем запись файла.

Если вы использовали midnight commander то нажмите Ctrl + O, это скроет панели, отобразив терминал, но не закроет сам MC, так же как и не прервет сессию **sudo**. Повторное нажатие вернет панели обратно.

Перезапустим наш сервис SSH, что бы применить внесенные изменения.

```bash
sudo systemctl restart ssh
```

Можно отключится напечатав **exit**, и подключится опять, для проверки работоспособности, он это необязательно.



